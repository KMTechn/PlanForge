# PlanForge Pro: 출고 계획 시스템 사용자 매뉴얼

## 1. 프로그램 개요

**PlanForge Pro**는 고객사의 주간 생산 계획과 현재 부품 재고를 기반으로, 가장 효율적인 일일 부품 납품 계획을 자동으로 생성해주는 프로그램입니다. 이 시스템은 리드타임, 트럭 적재 용량 등 현실적인 제약 조건을 고려하여 비용을 최소화하고 생산 차질을 방지하는 것을 목표로 합니다.

---

## 2. 시스템 워크플로우 (사용법)

프로그램은 총 3단계의 간단한 워크플로우로 구성되어 있습니다.

### **1단계: 생산계획 불러오기**

1.  `1. 생산계획 불러오기` 버튼을 클릭합니다.
2.  고객사로부터 받은 주간 생산 계획이 담긴 **Excel 파일**을 선택합니다.
    *   **요구사항**: 파일 내에 `《HCO&DIS》`라는 이름의 시트가 있어야 하며, 특정 행에 `Cover glass Assy` 라는 헤더와 함께 모델명, 날짜별 생산량이 정리되어 있어야 합니다.
3.  파일이 성공적으로 로드되면, 프로그램 메인 화면에 모델별, 날짜별 전체 생산 계획이 표시됩니다.

### **2단계: 재고 반영 및 계획 시뮬레이션**

1.  `2. 재고 반영 및 계획 시뮬레이션` 버튼을 클릭합니다.
2.  현재고 데이터가 담긴 텍스트를 붙여넣는 팝업창이 나타납니다.
    *   **입력 형식**: 텍스트 파일이나 메일 등에서 현재고 데이터를 복사하여 그대로 붙여넣습니다. 프로그램이 자동으로 모델명과 재고 수량을 인식합니다. 재고 데이터에 날짜 정보(예: `08/12`)가 포함되어 있으면, 해당 날짜를 재고 기준일로 인식합니다.
3.  `확인`을 누르면 시뮬레이션이 실행됩니다.
4.  시뮬레이션이 완료되면, 메인 화면의 계획이 **일일 생산 계획**에서 **일일 출고 계획**으로 변경됩니다. 각 셀은 해당 날짜에 납품해야 할 부품의 총 수량을 의미합니다.
5.  특정 모델 행을 클릭하면, 하단 상세 정보 창에서 해당 모델의 상세 재고 변화 및 차수별 출고 계획을 그래프와 함께 확인할 수 있습니다.

### **3단계: 계획 내보내기 (Excel)**

1.  `3. 계획 내보내기 (Excel)` 버튼을 클릭합니다.
2.  생성된 전체 출고 계획과 차수별 상세 출고 계획이 포함된 Excel 파일을 저장할 위치와 파일명을 지정합니다.
3.  지정한 경로에 Excel 파일이 생성되며, 이를 물류팀이나 파트너사와 공유하여 실제 출고 작업을 진행할 수 있습니다.

---

## 3. 시뮬레이션 핵심 로직 상세 설명

본 시스템의 출고 계획은 다음과 같은 정교한 로직에 따라 결정됩니다.

### **핵심 변수**

*   **생산 계획 (수요)**: 고객사가 매일 생산해야 하는 부품의 수량.
*   **현재고 (공급)**: 고객사 창고에 보관 중인 부품의 수량.
*   **리드타임 (Lead Time)**: 부품을 발주해서 고객사 창고에 도착하기까지 걸리는 시간 (일). (예: 2일)
*   **트럭 용량**: 트럭 한 대에 실을 수 있는 최대 부품 수량 (팔레트 수 x 팔레트당 수량).

### **계산 프로세스**

1.  **필요 재고 계산 (Requirement Calculation)**
    *   시스템은 매일 "리드타임" 이후의 날짜를 내다보고 미리 부품을 준비해야 한다고 판단합니다.
    *   예를 들어, 리드타임이 2일일 때, 오늘(월요일) 출고하는 물량은 이틀 뒤(수요일) 생산에 사용될 것을 목표로 합니다.
    *   이때, 단순히 수요일 생산량만 고려하는 것이 아니라, **오늘(월)부터 화요일까지의 생산으로 인해 소모될 재고량까지 모두 계산에 포함**합니다.
    *   따라서, 계산 공식은 다음과 같습니다.
        > **오늘 필요한 총 출고량** = (오늘부터 리드타임 후의 날짜까지 필요한 총 생산량) - (현재고) + (어제 미처 보내지 못한 물량)

2.  **우선순위 결정 (Prioritization)**
    *   여러 품목의 재고가 동시에 부족할 경우, 시스템은 더 시급한(부족 현상이 더 빨리 발생하는) 품목을 최우선으로 출고 계획에 포함시킵니다.

3.  **트럭 할당 (Truck Allocation)**
    *   결정된 우선순위에 따라, 하루에 운행 가능한 트럭의 용량(예: 1차, 2차)에 맞게 출고 물량을 할당합니다.

4.  **선제적 출고 (Proactive Shipment)**
    *   당장 시급한 물량을 모두 트럭에 싣고도 공간이 남는 경우, 시스템은 낭비를 줄이기 위해 **미래에 필요할 물량을 예측하여 미리 당겨서 출고**합니다. 이를 통해 트럭의 적재 효율을 극대화합니다.

---

## 4. 설정 및 기타 기능

### **시스템 설정 (`config.xlsx`)**
프로그램 폴더에 있는 `config.xlsx` 파일을 통해 시뮬레이션의 주요 변수를 직접 수정할 수 있습니다.
*   `ALLOWED_MODELS`: 관리할 모델 번호 목록
*   `HIGHLIGHT_MODELS`: 메인 화면에서 특별히 강조하여 표시할 모델 번호 목록
*   `PALLET_SIZE`: 팔레트당 부품 수량
*   `LEAD_TIME_DAYS`: 리드타임 (일)
*   `PALLETS_PER_TRUCK`: 트럭당 최대 팔레트 수
*   `MAX_TRUCKS_PER_DAY`: 하루 최대 운행 차수

### **UI 편의 기능**
*   **품목 검색**: 상단의 검색창을 통해 특정 모델을 쉽게 찾아볼 수 있습니다.
*   **폰트 크기 조절**: 좌측의 `+`, `-` 버튼으로 화면의 글자 크기를 조절할 수 있습니다.
*   **설정 저장 및 재계산**: 좌측의 시스템 설정값을 변경한 후 `설정 저장 및 재계산` 버튼을 누르면, 변경된 설정으로 즉시 시뮬레이션이 다시 실행됩니다.
